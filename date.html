<!-- 4ì¼ì°¨ ìº˜ë¦°ë” ë§Œë“¤ê¸° -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Calendar</title>
</head>

<body>

    <!--ìº˜ë¦°ë” ë¶€ë¶„ ì¶œì²˜ :https://gurtn.tistory.com/54 -->
    <div class='rap'>
        <div class="header">
            <div class="btn prevDay"></div>
            <h2 class='dateTitle'></h2>
            <div class="btn nextDay"></div>
        </div>

        <div class="grid dateHead">
            <div>ì¼</div>
            <div>ì›”</div>
            <div>í™”</div>
            <div>ìˆ˜</div>
            <div>ëª©</div>
            <div>ê¸ˆ</div>
            <div>í† </div>
        </div>

        <div class="grid dateBoard" id='day'></div>
    </div>

    <!-- ì—¬ê¸°ê°€ ë©”ëª¨ ë¶€ë¶„ -->
    <div class="memoContainer">
        <div class="memoTitle">ğŸ“ë©”ëª¨</div>
        <div class="memoList" id="memoList"></div>
    </div>

</body>

<script>
    // ë©”ëª¨ ì…ë ¥ -->>data
    const data = [];
    

    // ex 01:14 ì´ëŸ°ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì£¼ëŠ” ë¶€ë¶„
    const calendarList = data.reduce(
        (acc, v) => ({ ...acc, [v.date]: [...(acc[v.date] || []), v.content] }),
        {}
    );

    // 1ì›” -> 01ì›”ë¡œ ë‚˜íƒ€ë‚´ì£¼ëŠ” ë¶€ë¶„
    Number.prototype.pad = function () {
        return this > 9 ? this : '0' + this;
    }

    //ì—¬ê¸°ê°€ ë‹¬ë ¥ì„ ë‚˜íƒ€ë‚´ì£¼ëŠ” ë¶€ë¶„ = makeCalendar ì¶œì²˜ :https://gurtn.tistory.com/54 
    const makeCalendar = (date) => {
        const currentYear = new Date(date).getFullYear();
        const currentMonth = new Date(date).getMonth() + 1;

        const firstDay = new Date(date.setDate(1)).getDay();
        const lastDay = new Date(currentYear, currentMonth, 0).getDate();

        const limitDay = firstDay + lastDay;
        const nextDay = Math.ceil(limitDay / 7) * 7;

        let htmlDummy = '';

        for (let i = 0; i < firstDay; i++) {
            htmlDummy += `<div class="noColor"></div>`;
        }

        for (let i = 1; i <= lastDay; i++) {
            const isDayInList = calendarList[`${currentYear}-${currentMonth.pad()}-${i.pad()}`] && calendarList[`${currentYear}-${currentMonth.pad()}-${i.pad()}`].length > 0;
            htmlDummy += `<div class="${isDayInList ? 'hasTask' : ''}" onclick="handleDateClick(${i})">${i}</div>`;
        }

        for (let i = limitDay; i < nextDay; i++) {
            htmlDummy += `<div class="noColor"></div>`;
        }

        document.querySelector(`.dateBoard`).innerHTML = htmlDummy;
        document.querySelector(`.dateTitle`).innerText = `${currentYear}ë…„ ${currentMonth}ì›”`;
    }

    //ë‚ ì§œ dateë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•¨ã„´
    const date = new Date();
    let currentYear; // ì „ì—­ ë³€ìˆ˜ì„ ì „ì—­  //ë³€ìˆ˜: ì–´ë””ì—ì„œë‚˜ ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜

  // ì—¬ê¸°ê°€ ë‚ ì§œì— ë©”ëª¨ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ë¶€ë¶„ : handleDateClick
function handleDateClick(day) {
    const clickedMonth = new Date(date).getMonth() + 1; //pcëŠ” 0ë¶€í„° ì½ì–´ê°€ì§€ê³  +1ì„ í•´ì¤Œ + ë‹¬ì„ ë‚˜íƒ€ëƒ„
    const formattedDate = `${currentYear}-${clickedMonth.pad()}-${day.pad()}`; // ë…„-ì›”-ì¼ë¡œ ë‚˜íƒ€ë‚´ê¸° ìœ„í•¨

    showMemo(formattedDate); // ë©”ëª¨ ë³´ì—¬ì£¼ê¸°(showMemo) + í•´ë‹¹ ë‚ ì§œë¥¼ ì•Œê¸° ìœ„í•´ (formattedDate)

    //ì´ê±´ ë©”ëª¨ë¥¼ ì—¬ëŸ¬ê°œ ì…ë ¥í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë¶€ë¶„
    const isDayInList = calendarList[formattedDate] && calendarList[formattedDate].length > 0;

    //ë©”ëª¨ ìˆ˜ì • ë¶€ë¶„
    if (isDayInList) { 
        const memoIndex = prompt('ìˆ˜ì •í•  ë©”ëª¨ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥'); //ë©”ëª¨ë¥¼ ì—¬ëŸ¬ê°œ ì…ë ¥í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì •í™•í•˜ê²Œ ì–´ëŠ ë©”ëª¨ì¸ì§€ íŒë³„í•˜ê¸° ìœ„í•¨
        const existingMemo = calendarList[formattedDate][memoIndex - 1]; // ìˆ˜ì • = existingMemo


         // ë©”ëª¨ ìˆ˜ì •
        if (existingMemo) {
            const updatedMemo = prompt('ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥', existingMemo);

            
            calendarList[formattedDate][memoIndex - 1] = updatedMemo;

            // í™”ë©´ ê°±ì‹ 
            showMemo(formattedDate);
        } else { //ë²ˆí˜¸ë¥¼ ì˜ëª» ì…ë ¥í–ˆì„ ì‹œ
            alert('í•´ë‹¹ ë©”ëª¨ê°€ ì¡´ì¬x');
        }
    } else {
        addMemo(formattedDate); // ë©”ëª¨ ì…ë ¥ ê°€ëŠ¥í•œ ë¶€ë¶„ ë³´ì—¬ì£¼ê¸°
    }
}


    // ë‚ ì§œ í´ë¦­ ì‹œ ë©”ëª¨ë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜ = showMemo
    function showMemo(date) {
        const memoContent = calendarList[date] || []; //ë©”ëª¨ë‚´ìš© = memoContentì„ ë§Œì•½ ë©”ëª¨ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ë‚´ìš©ì„ ë³´ì—¬ì£¼ê³  ì—†ìœ¼ë©´ ë¹ˆì¹¸
        const memoHTML = memoContent.map(content => `<p style="color: aqua;">${content}</p>`).join(''); //ë©”ëª¨ ë‚´ìš©ì„ ë³´ì—¬ì£¼ê¸° mapì€ ë°°ì—´ì„ ìœ„í•¨

        // ë©”ëª¨ ë³´ì—¬ì£¼ëŠ” ê³³(memoContainer) ê°±ì‹  ë¶€ë¶„
        const memoContainer = document.querySelector('.memoContainer .memoList');
        memoContainer.innerHTML = memoHTML;
    }

    // ë©”ëª¨ì…ë ¥í•˜ëŠ” í™”ë©´? ë¶€ë¶„
    function addMemo(date) {
        const memoContent = prompt('ë©”ëª¨ ì…ë ¥');

        // ë©”ëª¨ ë°ì´í„°ì— ì¶”ê°€
        calendarList[date] = calendarList[date] || []; //ì—¬ê¸°ë„ ìœ„ì˜ const memoContentì—¬ê¸°ë‘ ë™ì¼
        calendarList[date].push(memoContent); // ì…ë ¥í•œ ë‚´ìš©  -> memoContent ì—¬ê¸°ë¡œ í‘¸ì‹œ

        // ë©”ëª¨ê°€ ìˆëŠ” ë‚ ì§œì— ë™ê·¸ë¼ë¯¸ë¡œ í‘œì‹œ
        const dateBoardDivs = document.querySelectorAll('.dateBoard div'); //ìœ„ì¹˜ dateBoard
        const day = new Date(date).getDate(); //ë‚ ì§œ date
        const isDayInList = calendarList[date] && calendarList[date].length > 0; //0ë³´ë‹¤ ì»¤ì•¼ ìˆë‹¤ëŠ” ê²ƒìœ¼ë¡œ ì˜ë¯¸
        dateBoardDivs[day].classList.toggle('hasMemo', isDayInList); // í•´ë‹¹í•˜ëŠ” ê³³ì— hasMemo(ë™ê·¸ë¼ë¯¸)í‘œì‹œë¥¼ ìœ„í•¨
    }

    makeCalendar(date);//ì´ê²Œ ìˆì–´ì•¼ ë‹¬ë ¥ì´ ë³´ì„
    currentYear = new Date(date).getFullYear(); // ì´ˆê¸°ì— ë…„ë„ ì„¤ì •

    // ì´ì „ë‹¬ ì´ë™
    document.querySelector(`.prevDay`).onclick = () => {
        makeCalendar(new Date(date.setMonth(date.getMonth() - 1)));
        currentYear = new Date(date).getFullYear(); // ë…„ë„ ì—…ë°ì´íŠ¸
    }

    // ë‹¤ìŒë‹¬ ì´ë™
    document.querySelector(`.nextDay`).onclick = () => {
        makeCalendar(new Date(date.setMonth(date.getMonth() + 1)));
        currentYear = new Date(date).getFullYear(); // ë…„ë„ ì—…ë°ì´íŠ¸
    }
</script>

<style> /* ì¶œì²˜ :https://gurtn.tistory.com/54  */
    .dateHead div {
        background: bluesky;
        color: black;
        text-align: center;
        border-radius: 5px;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        grid-gap: 5px;
        background-color: lightyellow;
    }

    .grid div {
        padding: .6rem;
        font-size: .9rem;
        cursor: pointer;
    }

    .dateBoard div {
        color: #222;
        font-weight: bold;
        min-height: 6rem;
        padding: .6rem .8rem;
        border-radius: 5px;
        border: 1px solid #eee;
    }

    .header {
        display: flex;
        justify-content: space-between;
        padding: 1rem 2rem;
    }

    /* ì¢Œìš° ë²„íŠ¼ */
    .btn {
        display: block;
        width: 20px;
        height: 20px;
        border: 3px solid #000;
        border-width: 3px 3px 0 0;
        cursor: pointer;
    }

    .prevDay {
        transform: rotate(-135deg);
    }

    .nextDay {
        transform: rotate(45deg);
    }

    .memoContainer {
        max-width: 820px;
        padding: 0 1.4rem;
        margin-top: 1.4rem;
    }

    .memoTitle {
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .memoList {
        display: flex;
        flex-direction: column;
    }

    .memo {
        border: 1px solid #eee;
        border-radius: 5px;
        padding: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .memoContent {
        margin-right: 1rem;
    }

    .editButton,
    .deleteButton {
        cursor: pointer;
        border: none;
        background-color: #007bff;
        color: white;
        padding: 0.2rem 0.5rem;
        border-radius: 3px;
        margin-right: 0.5rem;
    }

    .editButton:hover,
    .deleteButton:hover {
        background-color: #0056b3;
    }

    /* ì—¬ê¸°ê°€ ë™ê·¸ë¼ë¯¸ ë‚˜íƒ€ë‚´ëŠ” ë¶€ë¶„ */
    .hasMemo {
        position: relative;
    }

    .hasMemo::before {
    content: '';
    position: absolute;
    
   
    width: 20px;
    height: 20px;
    background-color: transparent; 
    border: 1px solid red; 
    border-radius: 50%;
    display: block;
}

</style>

</html>
